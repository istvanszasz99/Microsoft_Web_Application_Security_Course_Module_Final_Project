@page "/cart"
@using ShopEase
@using Microsoft.AspNetCore.Authorization
@attribute [Authorize]

<h2>Shopping Cart</h2>

@if (CartProducts.Count == 0)
{
    <p>Your cart is empty.</p>
}
else
{
    <ul>
        @foreach (var product in CartProducts)
        {
            <li>@product.Name - $@product.Price <button @onclick="() => RemoveFromCart(product.ProductID)">Remove</button></li>
        }
    </ul>
    <p>Total: $@Total</p>
}

@code {
    private List<Product> CartProducts = new();
    private decimal Total => CartProducts.Sum(p => p.Price);

    public void AddProduct(Product product)
    {
        CartProducts.Add(product);
    }

    private void RemoveFromCart(int productId)
    {
        var product = CartProducts.FirstOrDefault(p => p.ProductID == productId);
        if (product != null)
        {
            CartProducts.Remove(product);
        }
    }
}
